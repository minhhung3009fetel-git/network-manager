# BÆ°á»›c 1: Táº¡o file Service Unit
ÄÃ¢y lÃ  file cáº¥u hÃ¬nh Ä‘á»ƒ "dáº¡y" cho há»‡ Ä‘iá»u hÃ nh biáº¿t cÃ¡ch cháº¡y script cá»§a báº¡n.

Má»Ÿ trÃ¬nh soáº¡n tháº£o vÄƒn báº£n vá»›i quyá»n root Ä‘á»ƒ táº¡o má»™t file má»›i:

sudo nano /etc/systemd/system/net-monitor.service

DÃ¡n toÃ n bá»™ ná»™i dung sau vÃ o file Ä‘Ã³.

[Unit]
Description=Network Connection Monitoring Service
After=network.target

[Service]
# Thay 'minhhung' báº±ng username cá»§a báº¡n náº¿u khÃ¡c
User=minhhung
Group=minhhung

# THAY Äá»”I ÄÆ¯á»œNG DáºªN NÃ€Y cho Ä‘Ãºng vá»›i thÆ° má»¥c dá»± Ã¡n cá»§a báº¡n
WorkingDirectory=/home/minhhung/network_manager

# THAY Äá»”I ÄÆ¯á»œNG DáºªN NÃ€Y cho Ä‘Ãºng vá»›i file python trong mÃ´i trÆ°á»ng áº£o
ExecStart=/home/minhhung/network_manager/venv/bin/python monitor.py

Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target

Ráº¥t quan trá»ng: Báº¡n cáº§n thay Ä‘á»•i láº¡i 2 Ä‘Æ°á»ng dáº«n (WorkingDirectory vÃ  ExecStart) cho chÃ­nh xÃ¡c vá»›i vá»‹ trÃ­ báº¡n lÆ°u dá»± Ã¡n trÃªn server.

Nháº¥n Ctrl+X, sau Ä‘Ã³ Y, vÃ  Enter Ä‘á»ƒ lÆ°u vÃ  thoÃ¡t.

## BÆ°á»›c 2: Quáº£n lÃ½ Service báº±ng systemctl
Sau khi táº¡o file cáº¥u hÃ¬nh, báº¡n cáº§n dÃ¹ng cÃ¡c lá»‡nh sau Ä‘á»ƒ quáº£n lÃ½ dá»‹ch vá»¥.

Táº£i láº¡i cáº¥u hÃ¬nh systemd: Lá»‡nh nÃ y Ä‘á»ƒ há»‡ thá»‘ng nháº­n diá»‡n Ä‘Æ°á»£c file service má»›i cá»§a báº¡n.

Bash

sudo systemctl daemon-reload
KÃ­ch hoáº¡t service Ä‘á»ƒ tá»± cháº¡y khi khá»Ÿi Ä‘á»™ng:

Bash

sudo systemctl enable net-monitor.service
Khá»Ÿi Ä‘á»™ng service ngay láº­p tá»©c:

Bash

sudo systemctl start net-monitor.service
Kiá»ƒm tra tráº¡ng thÃ¡i service: ÄÃ¢y lÃ  lá»‡nh quan trá»ng nháº¥t Ä‘á»ƒ xem service cÃ³ Ä‘ang cháº¡y á»•n Ä‘á»‹nh khÃ´ng.

Bash

sudo systemctl status net-monitor.service
Náº¿u báº¡n tháº¥y dÃ²ng chá»¯ active (running) mÃ u xanh lÃ¡, cÃ³ nghÄ©a lÃ  má»i thá»© Ä‘Ã£ thÃ nh cÃ´ng!

## CÃ¡ch xem Log (Nháº­t kÃ½)
Khi script cháº¡y ná»n, nÃ³ sáº½ khÃ´ng in ra mÃ n hÃ¬nh ná»¯a. Äá»ƒ xem cÃ¡c dÃ²ng log (âœ… Káº¿t ná»‘i á»•n Ä‘á»‹nh, ğŸš¨ Máº¥t káº¿t ná»‘i, v.v.), báº¡n hÃ£y dÃ¹ng lá»‡nh:

Bash

journalctl -u net-monitor.service -f
journalctl -u net-monitor.service: Xem toÃ n bá»™ log tá»« trÆ°á»›c Ä‘áº¿n giá».

ThÃªm cá» -f: Theo dÃµi log theo thá»i gian thá»±c (giá»‘ng tail -f).

Báº¡n cáº§n thá»±c hiá»‡n cÃ¡c bÆ°á»›c trÃªn cho cáº£ hai server HN vÃ  HCM. Sau khi hoÃ n táº¥t, há»‡ thá»‘ng giÃ¡m sÃ¡t cá»§a báº¡n Ä‘Ã£ chÃ­nh thá»©c Ä‘i vÃ o hoáº¡t Ä‘á»™ng tá»± Ä‘á»™ng!
